/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Control","sap/ui/model/json/JSONModel","sap/f/cards/Data","sap/base/Log"],function(C,J,D,L){"use strict";var B=C.extend("sap.f.cards.BaseContent",{metadata:{properties:{configuration:{type:"object"}},aggregations:{_content:{multiple:false,visibility:"hidden"}}},constructor:function(i,s){if(typeof i!=="string"){s=i;}if(s&&s.serviceManager){this._oServiceManager=s.serviceManager;delete s.serviceManager;}C.apply(this,arguments);},renderer:function(r,c){var s="sapFCard";var l=c.getMetadata().getLibraryName();var n=c.getMetadata().getName();s+=n.slice(l.length+1,n.length);r.write("<div");r.writeElementData(c);r.addClass(s);r.writeClasses();r.write(">");r.renderControl(c.getAggregation("_content"));r.write("</div>");}});B.prototype.init=function(){var m=new J();this.setModel(m);};B.prototype.destroy=function(){this.setAggregation("_content",null);this.setModel(null);if(this._dataChangeHandler&&this._oDataService){this._oDataService.detachDataChanged(this._dataChangeHandler);this._dataChangeHandler=null;this._oDataService=null;}return C.prototype.destroy.apply(this,arguments);};B.prototype.setConfiguration=function(c){this.setProperty("configuration",c);if(!c){return this;}if(c.data){this._setData(c.data);}return this;};B.prototype._setData=function(d){var r=d.request;var s=d.service;this.bindElement({path:d.path||"/"});if(d.json&&!r){this._updateModel(d.json);}if(s){this._oServiceManager.getService("sap.ui.integration.services.Data").then(function(o){if(o){this._dataChangeHandler=function(e){this._updateModel(e.data);}.bind(this);o.getData().then(function(a){this._updateModel(a);}.bind(this)).catch(function(){L.error("Card content data service failed to get data");});o.attachDataChanged(this._dataChangeHandler,d.service.parameters);this._oDataService=o;}}.bind(this)).catch(function(){L.error("Data service unavailable");});}else if(r){D.fetch(r).then(function(a){this._updateModel(a,d.path);}.bind(this)).catch(function(e){L.error("Card content data request failed");});}};B.prototype._updateModel=function(d){this.getModel().setData(d);setTimeout(function(){this.fireEvent("_updated");}.bind(this),0);};return B;});
